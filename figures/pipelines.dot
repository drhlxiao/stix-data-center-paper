
/*digraph G {

	subgraph cluster_0 {
		style=filled;
		color=lightgrey;
		node [style=filled,color=white];
		a0 -> a1 -> a2 -> a3;
		label = "process #1";
	}

	subgraph cluster_1 {
		node [style=filled];
		b0 -> b1 -> b2 -> b3;
		label = "process #2";
		color=blue
	}
	start -> a0;
	start -> b0;
	a1 -> b3;
	b2 -> a3;
	a3 -> a0;
	a3 -> end;
	b3 -> end;

	start [shape=Mdiamond];
	end [shape=Msquare];
} */


digraph N {
    rankdir = TB;
    #ranksep=0.5;
        
    graph[pad="0.", nodesep="0.4", ranksep="0.1",splines = polyline]
compound=true;   


#subgraph raw_processing{ 
    style=filled;
    color=blue;
     

	node [shape=rect]; parser[label="Raw data parser"]; 
    node [shape=none]; idb[label="IDB"]; 
     raw[label="Raw telemetry data"]; spice[label="SPICE kernel data"];
    node[shape=cylinder]; nosqldb[label="NoSQL database",  ];
	
    node[shape=none];
   
    
    raw -> parser;
    idb -> parser;
    spice -> parser;
    parser->nosqldb [label="Packets and\n metadata"];
#}

#subgraph l1processing{
    #rankdir=LR;
	#layout=neato
    node[shape=rect]; flaredet[label="Flare detection", width=2]; 
    node [shape=rect]; flaredp[label="Flaring data\n processing pipeline"]; cal[label="Calibration data \n processing pipeline"];
    fitsio[label="FITS file writer"];
    node [shape=none]; l23[label="To higher data products or \n scientific analysis"];
	node [shape=ellipse]; l1a[label="L1A FITS products"];
    #node[shape=none] 
 
    
    nosqldb->cal[label="Spectra"];
    cal->nosqldb[label="Calibration\nparameters"];
    cal->"Calibration reports";
    nosqldb->fitsio [label="L1 Packets"];
    fitsio -> nosqldb [label="Metadata"];

    fitsio->l1a;
    nosqldb->flaredet [label="Light \n curves"];
    flaredet->nosqldb[label="Flare list"];
    flaredet->"Flare list";
    l1a->l23;

    flaredp->"Flaring data \n quick-look products";
    nosqldb->flaredp[label="L1 Sciecne data \nand flare list" ];
    flaredp->nosqldb[label="Metadata"]

#}
	

	label = "\n\nData processing pipelines at STIX data center";
	fontsize=20;
}


